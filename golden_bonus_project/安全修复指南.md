# ğŸ”’ API Key å®‰å…¨ä¿®å¤æŒ‡å—

## âš ï¸ å‘ç°çš„é—®é¢˜

æ‚¨çš„ API key å·²ç»è¢«æäº¤åˆ° GitHub å…¬å¼€ä»“åº“çš„ git å†å²ä¸­ã€‚è¿™éœ€è¦ç«‹å³å¤„ç†ã€‚

## âœ… å·²å®Œæˆçš„ä¿®å¤

1. âœ… å·²ä»æ‰€æœ‰æ–‡æ¡£æ–‡ä»¶ä¸­ç§»é™¤çœŸå®çš„ API key
2. âœ… å·²å°†æ‰€æœ‰ç¤ºä¾‹æ›¿æ¢ä¸ºå ä½ç¬¦ `your-gemini-api-key-here`
3. âœ… `.gitignore` å·²æ­£ç¡®é…ç½®ï¼ˆåŒ…å« `.env`ï¼‰

## ğŸš¨ ç´§æ€¥è¡ŒåŠ¨ï¼šæ’¤é”€å·²æ³„éœ²çš„ API Key

**é‡è¦**ï¼šç”±äº API key å·²ç»æ³„éœ²ï¼Œæ‚¨éœ€è¦ï¼š

### æ­¥éª¤ 1ï¼šåœ¨ Google AI Studio ä¸­æ’¤é”€æ—§ API Key

1. å‰å¾€ [Google AI Studio - API Keys](https://makersuite.google.com/app/apikey)
2. æ‰¾åˆ°å·²æ³„éœ²çš„ API key
3. ç‚¹å‡» "Delete" æˆ– "Revoke" æ’¤é”€å®ƒ
4. åˆ›å»ºæ–°çš„ API key

### æ­¥éª¤ 2ï¼šä» Git å†å²ä¸­ç§»é™¤æ•æ„Ÿä¿¡æ¯

**è­¦å‘Š**ï¼šè¿™ä¼šé‡å†™ git å†å²ï¼Œéœ€è¦å¼ºåˆ¶æ¨é€ã€‚å¦‚æœå…¶ä»–äººä¹Ÿåœ¨ä½¿ç”¨è¿™ä¸ªä»“åº“ï¼Œè¯·å…ˆé€šçŸ¥ä»–ä»¬ã€‚

#### æ–¹æ³• Aï¼šä½¿ç”¨ git filter-repoï¼ˆæ¨èï¼‰

```bash
# å®‰è£… git-filter-repoï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
pip install git-filter-repo

# ä»æ‰€æœ‰å†å²ä¸­ç§»é™¤åŒ…å« API key çš„æ–‡ä»¶å†…å®¹
cd /Users/jackm4/Documents/GitHub/AI-Year-End-Bonus-Consultant

# å¤‡ä»½å½“å‰åˆ†æ”¯
git branch backup-before-cleanup

# ç§»é™¤æ‰€æœ‰å†å²ä¸­çš„ API keyï¼ˆæ›¿æ¢ä¸ºå ä½ç¬¦ï¼‰
git filter-repo --replace-text <(echo "AIzaSyBXtR92jUgrhxaxF7_sC6DN1RnwIiAxT_8==>your-gemini-api-key-here")
git filter-repo --replace-text <(echo "AIzaSyD8YF-WMvUdDJOIJ8p7Eh9B06-I_ZfPJVs==>your-gemini-api-key-here")

# å¼ºåˆ¶æ¨é€åˆ°è¿œç¨‹ï¼ˆâš ï¸ è¿™ä¼šè¦†ç›–è¿œç¨‹å†å²ï¼‰
git push origin --force --all
```

#### æ–¹æ³• Bï¼šä½¿ç”¨ BFG Repo-Cleanerï¼ˆæ›´ç®€å•ï¼‰

```bash
# ä¸‹è½½ BFGï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
# ä» https://rtyley.github.io/bfg-repo-cleaner/ ä¸‹è½½

# åˆ›å»ºæ›¿æ¢æ–‡ä»¶
echo "AIzaSyBXtR92jUgrhxaxF7_sC6DN1RnwIiAxT_8==>your-gemini-api-key-here" > replacements.txt
echo "AIzaSyD8YF-WMvUdDJOIJ8p7Eh9B06-I_ZfPJVs==>your-gemini-api-key-here" >> replacements.txt

# æ¸…ç†å†å²
java -jar bfg.jar --replace-text replacements.txt

# æ¸…ç†å¹¶æ¨é€
git reflog expire --expire=now --all
git gc --prune=now --aggressive
git push origin --force --all
```

#### æ–¹æ³• Cï¼šæ‰‹åŠ¨åˆ é™¤å¹¶é‡æ–°åˆ›å»ºä»“åº“ï¼ˆæœ€ç®€å•ä½†ä¼šä¸¢å¤±å†å²ï¼‰

å¦‚æœä»“åº“å†å²ä¸é‡è¦ï¼š

```bash
# 1. åœ¨ GitHub ä¸Šåˆ é™¤ä»“åº“
# 2. é‡æ–°åˆ›å»ºä»“åº“
# 3. æ¨é€æ¸…ç†åçš„ä»£ç 
git remote remove origin
git remote add origin <new-repo-url>
git push -u origin main
```

### æ­¥éª¤ 3ï¼šæ›´æ–°æœ¬åœ°å’Œ Streamlit Cloud çš„ API Key

1. **æ›´æ–°æœ¬åœ° `.env` æ–‡ä»¶**ï¼š
   ```bash
   echo "GEMINI_API_KEY=ä½ çš„æ–°API_KEY" > golden_bonus_project/.env
   ```

2. **æ›´æ–° Streamlit Cloud Secrets**ï¼š
   - å‰å¾€ Streamlit Cloud æ§åˆ¶å°
   - æ›´æ–° Secrets ä¸­çš„ `GEMINI_API_KEY` ä¸ºæ–°å€¼

## ğŸ›¡ï¸ é¢„é˜²æªæ–½

### 1. æ£€æŸ¥ .gitignore

ç¡®ä¿ `.gitignore` åŒ…å«ï¼š
```
.env
.streamlit/secrets.toml
*.key
*secret*
*api*key*
```

### 2. ä½¿ç”¨ Git Hooks é˜²æ­¢æœªæ¥æ³„éœ²

åˆ›å»º `.git/hooks/pre-commit`ï¼š

```bash
#!/bin/sh
# æ£€æŸ¥æ˜¯å¦åŒ…å« API key æ¨¡å¼
if git diff --cached | grep -E "AIzaSy[A-Za-z0-9_-]{35}" > /dev/null; then
    echo "âŒ é”™è¯¯ï¼šæ£€æµ‹åˆ°å¯èƒ½çš„ API keyï¼"
    echo "è¯·ç¡®ä¿ä¸è¦æäº¤çœŸå®çš„ API key åˆ°ä»“åº“ã€‚"
    exit 1
fi
```

### 3. ä½¿ç”¨ç¯å¢ƒå˜é‡æ£€æŸ¥è„šæœ¬

åˆ›å»º `scripts/check-secrets.sh`ï¼š

```bash
#!/bin/bash
# æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦åŒ…å«çœŸå®çš„ API key
if grep -r "AIzaSy[A-Za-z0-9_-]\{35\}" --exclude-dir=venv --exclude-dir=.git .; then
    echo "âš ï¸  è­¦å‘Šï¼šå‘ç°å¯èƒ½çš„ API keyï¼"
    exit 1
fi
```

### 4. ä½¿ç”¨ GitHub Secret Scanning

GitHub ä¼šè‡ªåŠ¨æ‰«æå…¬å¼€ä»“åº“ä¸­çš„ API keyã€‚å¦‚æœæ£€æµ‹åˆ°ï¼Œæ‚¨ä¼šæ”¶åˆ°é€šçŸ¥ã€‚

## ğŸ“‹ æ£€æŸ¥æ¸…å•

- [ ] å·²åœ¨ Google AI Studio ä¸­æ’¤é”€æ³„éœ²çš„ API key
- [ ] å·²åˆ›å»ºæ–°çš„ API key
- [ ] å·²ä» git å†å²ä¸­ç§»é™¤æ•æ„Ÿä¿¡æ¯
- [ ] å·²æ›´æ–°æœ¬åœ° `.env` æ–‡ä»¶
- [ ] å·²æ›´æ–° Streamlit Cloud Secrets
- [ ] å·²æ£€æŸ¥ `.gitignore` é…ç½®
- [ ] å·²è®¾ç½® pre-commit hookï¼ˆå¯é€‰ä½†æ¨èï¼‰

## ğŸ” éªŒè¯ä¿®å¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ²¡æœ‰æ•æ„Ÿä¿¡æ¯ï¼š

```bash
# æ£€æŸ¥å·¥ä½œç›®å½•
grep -r "AIzaSy" --exclude-dir=venv --exclude-dir=.git .

# æ£€æŸ¥ git å†å²ï¼ˆåº”è¯¥åªæ˜¾ç¤ºå ä½ç¬¦ï¼‰
git log -p | grep "AIzaSy"
```

## âš ï¸ é‡è¦æé†’

1. **æ°¸è¿œä¸è¦**åœ¨ä»£ç ã€æ–‡æ¡£æˆ–é…ç½®æ–‡ä»¶ä¸­ç¡¬ç¼–ç  API key
2. **æ°¸è¿œä½¿ç”¨**ç¯å¢ƒå˜é‡æˆ– Secrets ç®¡ç†
3. **å®šæœŸè½®æ¢** API keyï¼ˆæ¯ 3-6 ä¸ªæœˆï¼‰
4. **ç›‘æ§ä½¿ç”¨æƒ…å†µ**ï¼Œå‘ç°å¼‚å¸¸ç«‹å³æ’¤é”€

## ğŸ†˜ å¦‚æœ API Key å·²è¢«æ»¥ç”¨

å¦‚æœå‘ç° API key è¢«æ»¥ç”¨ï¼š

1. ç«‹å³åœ¨ Google AI Studio ä¸­æ’¤é”€
2. æ£€æŸ¥ API ä½¿ç”¨æ—¥å¿—
3. è”ç³» Google Cloud æ”¯æŒ
4. è€ƒè™‘å¯ç”¨ API ä½¿ç”¨é™åˆ¶å’Œé…é¢

